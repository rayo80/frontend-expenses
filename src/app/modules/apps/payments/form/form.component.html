<div class="flex flex-col gap-2">
    <h3 mat-dialog-title class="grow text-3xl font-semibold">Generar Movimiento de Pago </h3>
      <mat-dialog-content class="p-2">
        <form [formGroup]="formInstance" class="grid grid-cols-10 grid-flow-row gap-2 max-w-screen-sm">
          <!-- Tipo de operaciÃ³n -->
          <div class="col-span-10 flex justify-center">
            <mat-form-field appearance="fill" class="col-span-5 fuse-mat-bold fuse-mat-dense bg-accent">
              <mat-select formControlName="tipo_operacion" (selectionChange)="onTipoOperacionChange()">
              <mat-option [value]="1">Pago de Compra</mat-option>
              <mat-option [value]="2">Transferencia Bancaria</mat-option>
              <mat-option [value]="3">Egreso con Concepto</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <mat-form-field appearance="outline" class="col-span-4">
            <mat-label>Medio de Pago</mat-label>
            <mat-select formControlName="metodo">
                <mat-option *ngFor="let metodo of metodos" [value]="metodo.id">
                  {{metodo.name}}
                </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="outline" class="col-span-3">
            <mat-label>Moneda</mat-label>
            <mat-select formControlName="moneda">
                <mat-option *ngFor="let moneda of monedas" [value]="moneda.id">
                  {{moneda.nombre + " ("+moneda.simbolo+")" }}
                </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="outline" class="col-span-3">
            <mat-label>Total</mat-label>
            <input formControlName="total" matInput>
            <mat-error *ngIf="formInstance.get('total')?.errors?.['required']"
                  [style.font-size]="'x-smaller'"
            >Campo requerido</mat-error>
          </mat-form-field>
          <mat-form-field appearance="outline" class="col-span-4">
            <mat-label>Fecha</mat-label>
            <input formControlName="fecha_documento" matInput [matDatepicker]="picker1">
            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>
          <mat-form-field appearance="outline" class="col-span-6">
            <mat-label>Detalles</mat-label>
            <input formControlName="referencia" matInput>
          </mat-form-field>
          <mat-form-field appearance="outline" disabled=True class="col-span-5">
            <mat-label>Origen</mat-label>
            <input formControlName="referencia" matInput>
          </mat-form-field>
          <mat-form-field appearance="outline" disabled=False class="col-span-5">
            <mat-label>Destino</mat-label>
            <input formControlName="referencia" matInput>
          </mat-form-field>
          <div *ngIf="tipoOperacion === 1" class="bg-gray-50 dark:bg-accent-700 p-2 grid col-span-10 grid-cols-10 grid-flow-row gap-2 max-w-screen-sm">
            <mat-form-field appearance="outline" class="col-span-5">
              <mat-label>Compra</mat-label>
              <mat-select formControlName="compras">
                  <mat-option *ngFor="let compra of compras" [value]="compra.id">
                    {{compra.numero_documento +'  '+ compra.proveedorName}}
                  </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field appearance="outline" class="col-span-3">
              <mat-label>Numero de Documento Referencia</mat-label>
              <input formControlName="referencia" matInput>
              <mat-error *ngIf="formInstance.get('referencia')?.errors?.['required']"
                    [style.font-size]="'x-smaller'"
              >Campo requerido</mat-error>
            </mat-form-field>
            <button mat-raised-button class="col-span-2" (click)="crearNuevaCompra()" color="primary">Agregar</button>
            
          </div>

        <div *ngIf="tipoOperacion === 3" class="bg-gray-50 dark:bg-accent-700 p-2 grid col-span-10 grid-cols-10 grid-flow-row gap-2 max-w-screen-sm">
          <mat-form-field appearance="outline" class="col-span-7">
            <mat-label>Concepto</mat-label>
            <mat-select formControlName="metodo">
                <mat-option *ngFor="let product of products" [value]="product.id">
                  {{product.name}}
                </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
          <div class="alert alert-danger col-span-10" *ngIf="error">
            Los campos no han sido rellanados correctamente
          </div>
        </form>
  
  
      </mat-dialog-content>
      <mat-dialog-actions>
        <button mat-raised-button (click)="onSubmit()" color="primary">Guardar</button>
      </mat-dialog-actions>
  
  </div>